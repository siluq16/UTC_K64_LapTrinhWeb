@model IEnumerable<Day13Lab_Lab3.Models.Learner>

@{
    ViewData["Title"] = "Learners";
}

<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="fw-bold">Danh sách Learner</h2>
        @await Component.InvokeAsync("Major")
        <form class="form-check-inline ms-auto me-3">
            <div class="input-group">
                <input id="keyword" class="form-control" type="text" placeholder="Search..." />
                <button class="btn btn-primary" id="btnSearch" type="button">
                    <i class="bi bi-search"></i>
                </button>
            </div>
        </form>
        <a asp-action="Create" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> Thêm mới
        </a>
    </div>

    <div id="content">
        @Html.Partial("LearnerTable", Model)
    </div>
</div>

@section Scripts{
    <script>
        // --- Bấm chọn Major ---
        $(document).on("click", ".learner-link", function (e) {
            e.preventDefault();

            $.get("@Url.Action("LearnerFilter")",
                { mid: $(this).data("id"), page: 1 },
                function (res) {
                    $("#content").html(res);
                });
        });

        // --- Search ---
        $("#btnSearch").click(function () {
            let keyword = $("#keyword").val();

            $.get("@Url.Action("LearnerFilter")", { keyword: keyword, page: 1 },
                function (res) {
                    $("#content").html(res);
                });
        });

        // --- Phân trang ---
        $(document).on("click", ".page-link", function () {

            let page = $(this).data("page");
            let mid = $(this).data("mid");
            let keyword = $(this).data("keyword");

            $.get("@Url.Action("LearnerFilter")",
                { page: page, mid: mid, keyword: keyword },
                function (res) {
                    $("#content").html(res);
                });
        });
    </script>

}